{
  "summary": {
    "medium": 34,
    "low": 22,
    "high": 17,
    "info": 1
  },
  "by_severity": {
    "medium": [
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'build.architecture-mission' has 9 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/build.architecture-mission/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'build.technical-research' has 13 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/build.technical-research/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'design.ux-research-summary' has 18 fields (max depth 3). Not referenced in code or tests.",
        "file": "templates/packs/design.ux-research-summary/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'discovery.go-no-go-synthesis' has 39 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/discovery.go-no-go-synthesis/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'discovery.opportunity-scan' has 30 fields (max depth 3). Not referenced in code or tests.",
        "file": "templates/packs/discovery.opportunity-scan/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'discovery.pivot-analysis' has 7 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/discovery.pivot-analysis/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'discovery.problem-definition' has 41 fields (max depth 3). Not referenced in code or tests.",
        "file": "templates/packs/discovery.problem-definition/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'discovery.research-orchestrator' has 54 fields (max depth 3). Not referenced in code or tests.",
        "file": "templates/packs/discovery.research-orchestrator/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'discovery.research-sub-mission' has 13 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/discovery.research-sub-mission/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'engineering.adr' has 8 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/engineering.adr/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'engineering.bug-fix' has 9 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/engineering.bug-fix/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'engineering.tdd' has 22 fields (max depth 3). Not referenced in code or tests.",
        "file": "templates/packs/engineering.tdd/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'market.customer-development' has 12 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/market.customer-development/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'process.code-review' has 42 fields (max depth 3). Not referenced in code or tests.",
        "file": "templates/packs/process.code-review/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'process.design-review' has 23 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/process.design-review/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'product.competitive-analysis' has 21 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/product.competitive-analysis/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'product.dashboard-blueprint' has 11 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/product.dashboard-blueprint/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'product.prd' has 32 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/product.prd/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'qa.bug-report' has 13 fields (max depth 1). Not referenced in code or tests.",
        "file": "templates/packs/qa.bug-report/template.yaml"
      },
      {
        "category": "domains",
        "severity": "medium",
        "message": "Domain pack 'research.general' has 14 fields (max depth 2). Not referenced in code or tests.",
        "file": "templates/packs/research.general/template.yaml"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/extraction/template-extractor.ts has 63 decision points, 635 total lines, longest function 84 lines.",
        "file": "src/extraction/template-extractor.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/versioning/version-manager.ts has 62 decision points, 471 total lines, longest function 66 lines.",
        "file": "src/versioning/version-manager.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/index.ts has 61 decision points, 881 total lines, longest function 374 lines.",
        "file": "src/index.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/intelligence/dependency-analyzer.ts has 56 decision points, 489 total lines, longest function 62 lines.",
        "file": "src/intelligence/dependency-analyzer.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/import-export/security-validator.ts has 41 decision points, 511 total lines, longest function 89 lines.",
        "file": "src/import-export/security-validator.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/combination/dependency-resolver.ts has 41 decision points, 376 total lines, longest function 62 lines.",
        "file": "src/combination/dependency-resolver.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/quality/analyzers/clarity-analyzer.ts has 37 decision points, 353 total lines, longest function 72 lines.",
        "file": "src/quality/analyzers/clarity-analyzer.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/domains/domain-pack-loader.ts has 34 decision points, 477 total lines, longest function 75 lines.",
        "file": "src/domains/domain-pack-loader.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/quality/analyzers/completeness-analyzer.ts has 34 decision points, 359 total lines, longest function 51 lines.",
        "file": "src/quality/analyzers/completeness-analyzer.ts"
      },
      {
        "category": "complexity",
        "severity": "medium",
        "message": "src/intelligence/mission-splitter.ts has 33 decision points, 649 total lines, longest function 42 lines.",
        "file": "src/intelligence/mission-splitter.ts"
      },
      {
        "category": "api",
        "severity": "medium",
        "message": "Tool naming mismatches (update_token_optimization vs optimize_tokens).",
        "file": "src/tools/optimize-tokens.ts, tests/tools/optimize-tokens.test.ts"
      },
      {
        "category": "api",
        "severity": "medium",
        "message": "Deprecated tool definitions still exported alongside canonical names, increasing maintenance burden.",
        "file": "src/tools/*.ts"
      },
      {
        "category": "tooling",
        "severity": "medium",
        "message": "No eslint/prettier configuration present; npm scripts reference tools but packages missing.",
        "file": "package.json:scripts"
      },
      {
        "category": "tooling",
        "severity": "medium",
        "message": "No automated complexity or performance profiling in CI; relies on manual inspection.",
        "file": "package.json, scripts/"
      }
    ],
    "low": [
      {
        "category": "domains",
        "severity": "low",
        "message": "Domain pack 'build.implementation' has 14 fields (max depth 1).",
        "file": "templates/packs/build.implementation/template.yaml"
      },
      {
        "category": "domains",
        "severity": "low",
        "message": "Domain pack 'business.market-research' has 13 fields (max depth 1).",
        "file": "templates/packs/business.market-research/template.yaml"
      },
      {
        "category": "domains",
        "severity": "low",
        "message": "Domain pack 'foundation' has 7 fields (max depth 1).",
        "file": "templates/packs/foundation/template.yaml"
      },
      {
        "category": "domains",
        "severity": "low",
        "message": "Domain pack 'software.technical-task' has 15 fields (max depth 2).",
        "file": "templates/packs/software.technical-task/template.yaml"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'getToolDefinitions' in src/index.ts lacks JSDoc coverage.",
        "file": "src/index.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'summarizeValue' in src/index.ts lacks JSDoc coverage.",
        "file": "src/index.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'sanitizeArgs' in src/index.ts lacks JSDoc coverage.",
        "file": "src/index.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'buildMissionProtocolContext' in src/index.ts lacks JSDoc coverage.",
        "file": "src/index.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'executeMissionProtocolTool' in src/index.ts lacks JSDoc coverage.",
        "file": "src/index.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export '__test__' in src/index.ts lacks JSDoc coverage.",
        "file": "src/index.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'exportTemplateToolDefinitionDeprecated' in src/tools/export-template.ts lacks JSDoc coverage.",
        "file": "src/tools/export-template.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'ScoreQualityInput' in src/tools/score-quality.ts lacks JSDoc coverage.",
        "file": "src/tools/score-quality.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'ScoreQualityOutput' in src/tools/score-quality.ts lacks JSDoc coverage.",
        "file": "src/tools/score-quality.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'CheckVersionCompatibilityParams' in src/tools/version-template.ts lacks JSDoc coverage.",
        "file": "src/tools/version-template.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'CheckVersionCompatibilityResult' in src/tools/version-template.ts lacks JSDoc coverage.",
        "file": "src/tools/version-template.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'checkVersionCompatibility' in src/tools/version-template.ts lacks JSDoc coverage.",
        "file": "src/tools/version-template.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'getVersionCompatibilityToolDefinition' in src/tools/version-template.ts lacks JSDoc coverage.",
        "file": "src/tools/version-template.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'checkVersionCompatibilityToolDefinitionDeprecated' in src/tools/version-template.ts lacks JSDoc coverage.",
        "file": "src/tools/version-template.ts"
      },
      {
        "category": "documentation",
        "severity": "low",
        "message": "Export 'FindMigrationPathParams' in src/tools/version-template.ts lacks JSDoc coverage.",
        "file": "src/tools/version-template.ts"
      },
      {
        "category": "security",
        "severity": "low",
        "message": "Security control: SecureYAMLLoader enforces base directory, file size limits, symlink rejection, and AJV schema validation before returning data.",
        "file": "src/loaders/yaml-loader.ts"
      },
      {
        "category": "security",
        "severity": "low",
        "message": "Security control: importTemplate validates template paths via safeFilePath and runs 6-layer security pipeline before materializing imports.",
        "file": "src/tools/import-template.ts"
      },
      {
        "category": "security",
        "severity": "low",
        "message": "Security control: Export flow sanitizes output path and restricts extensions, reducing traversal risk.",
        "file": "src/tools/export-template.ts"
      }
    ],
    "high": [
      {
        "category": "security",
        "severity": "high",
        "message": "Input validation only checks path existence; missionFile is resolved via fs.readFile without baseDir restriction or safeFilePath usage.",
        "file": "src/tools/split-mission.ts",
        "line": 217
      },
      {
        "category": "security",
        "severity": "high",
        "message": "writeSubMissions writes files into params.outputDir (defaulting to dirname of user-supplied missionFile) without sanitization, enabling overwrite outside workspace if absolute paths supplied.",
        "file": "src/tools/split-mission.ts",
        "line": 188
      },
      {
        "category": "security",
        "severity": "high",
        "message": "updateTokenOptimization resolves missionFile directly and overwrites original plus .backup without safeFilePath checks.",
        "file": "src/tools/optimize-tokens.ts",
        "line": 66
      },
      {
        "category": "security",
        "severity": "high",
        "message": "If optimization fails after backup creation, the original file may remain replaced (no rollback).",
        "file": "src/tools/optimize-tokens.ts",
        "line": 98
      },
      {
        "category": "security",
        "severity": "high",
        "message": "Fallback token counting exposes model names & text lengths via console.warn, which may leak metadata when running in shared environments.",
        "file": "src/intelligence/token-counters.ts",
        "line": 154
      },
      {
        "category": "testing",
        "severity": "high",
        "message": "TypeError: Cannot read properties of undefined (reading 'name')",
        "file": "tests/tools/optimize-tokens.test.ts"
      },
      {
        "category": "testing",
        "severity": "high",
        "message": "TS18046: 'data' is of type 'unknown'",
        "file": "tests/loaders/yaml-loader.test.ts"
      },
      {
        "category": "testing",
        "severity": "high",
        "message": "TS18048: 'result.migratedTemplate' is possibly 'undefined'",
        "file": "tests/versioning/migration-engine.test.ts"
      },
      {
        "category": "testing",
        "severity": "high",
        "message": "TS2353: Object literal may only specify known properties, and 'outputFormat' does not exist in type 'AnalyzeDependenciesArgs'",
        "file": "tests/integration/phase4-intelligence-flow.test.ts"
      },
      {
        "category": "testing",
        "severity": "high",
        "message": "TS18046: 'template.spec.phases' is of type 'unknown'",
        "file": "tests/import-export/security-validator.test.ts"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "No safeFilePath usage before reading user-provided mission file.",
        "file": "src/tools/split-mission.ts:217"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "No path sanitization or rollback for file writes.",
        "file": "src/tools/optimize-tokens.ts:66"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "Expectations reference optimizeTokensToolDefinition which no longer exists.",
        "file": "tests/tools/optimize-tokens.test.ts:235"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "Tests dereference unknown typed result; out of sync with SecureYAMLLoader API.",
        "file": "tests/loaders/yaml-loader.test.ts:59"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "Access to migratedTemplate without guards.",
        "file": "tests/versioning/migration-engine.test.ts:727"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "Legacy outputFormat argument removed from AnalyzeDependenciesArgs.",
        "file": "tests/integration/phase4-intelligence-flow.test.ts:254"
      },
      {
        "category": "technical_debt",
        "severity": "high",
        "message": "Assertions assume template.spec.phases typed.",
        "file": "tests/import-export/security-validator.test.ts:186"
      }
    ],
    "info": [
      {
        "category": "domains",
        "severity": "info",
        "message": "Domain root exists: True"
      }
    ]
  }
}